(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[4070],{82920:function(Ee,N,u){"use strict";u.r(N),u.d(N,{default:function(){return be}});var ae=u(11849),Fe=u(71194),O=u(50146),we=u(57663),x=u(71577),R=u(2824),r=u(39428),Ce=u(34792),b=u(48086),p=u(3182),W=u(57119),te=u(73171),H=u(49101),T=u(67294),l=u(43581),re=u(85224),se=u(69193),oe=u(33700),D=u(86072),xe="e98a";function ue(c){return B.apply(this,arguments)}function B(){return B=(0,p.Z)((0,r.Z)().mark(function c(n){var i;return(0,r.Z)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return i=new URLSearchParams(n).toString(),s.abrupt("return",(0,D.Z)("/monitor/jobLog/list?".concat(i),{data:n,method:"GET",headers:{"Content-Type":"application/json;charset=UTF-8"}}));case 2:case"end":return s.stop()}},c)})),B.apply(this,arguments)}function Re(c){return request("/monitor/jobLog/".concat(c),{method:"GET"})}function Je(c){return A.apply(this,arguments)}function A(){return A=_asyncToGenerator(_regeneratorRuntime().mark(function c(n){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",request("/monitor/jobLog",{method:"POST",data:n}));case 1:case"end":return t.stop()}},c)})),A.apply(this,arguments)}function Me(c){return G.apply(this,arguments)}function G(){return G=_asyncToGenerator(_regeneratorRuntime().mark(function c(n){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",request("/monitor/jobLog",{method:"PUT",data:n}));case 1:case"end":return t.stop()}},c)})),G.apply(this,arguments)}function Y(c){return P.apply(this,arguments)}function P(){return P=(0,p.Z)((0,r.Z)().mark(function c(n){return(0,r.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,D.Z)("/monitor/jobLog/".concat(n),{method:"DELETE",headers:{"Content-Type":"application/json;charset=UTF-8"}}));case 1:case"end":return t.stop()}},c)})),P.apply(this,arguments)}function le(c){return(0,oe.su)("/monitor/jobLog/export",{params:c},"job_log_".concat(new Date().getTime(),".xlsx"))}function ce(){return(0,D.Z)("/monitor/jobLog/clean",{method:"DELETE"})}var Oe=u(98858),E=u(4914),Ie=u(9715),ie=u(55843),e=u(85893),m="eWUU",de=function(n){var i=ie.Z.useForm(),t=(0,R.Z)(i,1),s=t[0],o=n.values,d=n.statusOptions,v=n.jobGroupOptions;(0,T.useEffect)(function(){s.resetFields(),s.setFieldsValue({jobLogId:n.values.jobLogId,jobName:n.values.jobName,jobGroup:n.values.jobGroup,invokeTarget:n.values.invokeTarget,jobMessage:n.values.jobMessage,status:n.values.status,exceptionInfo:n.values.exceptionInfo,createTime:n.values.createTime})},[s,n]);var $=(0,l.YB)(),U=function(){s.submit()},S=function(){n.onCancel(),s.resetFields()};return(0,e.jsx)(O.Z,{width:640,title:$.formatMessage({id:"monitor.JobLog.title",defaultMessage:"\u5B9A\u65F6\u4EFB\u52A1\u8C03\u5EA6\u65E5\u5FD7"}),visible:n.visible,destroyOnClose:!0,onOk:U,onCancel:S,_nk:"".concat(m,"11"),children:(0,e.jsxs)(E.Z,{column:24,_nk:"".concat(m,"21"),children:[(0,e.jsx)(E.Z.Item,{span:12,label:(0,e.jsx)(l._H,{id:"monitor.Job.job_id",defaultMessage:"\u4EFB\u52A1\u7F16\u53F7",_nk:"".concat(m,"41")}),_nk:"".concat(m,"31"),children:o.jobLogId}),(0,e.jsx)(E.Z.Item,{span:12,label:(0,e.jsx)(l._H,{id:"monitor.Job.create_time",defaultMessage:"\u6267\u884C\u65F6\u95F4",_nk:"".concat(m,"42")}),_nk:"".concat(m,"32"),children:o.createTime}),(0,e.jsx)(E.Z.Item,{span:12,label:(0,e.jsx)(l._H,{id:"monitor.Job.job_name",defaultMessage:"\u4EFB\u52A1\u540D\u79F0",_nk:"".concat(m,"43")}),_nk:"".concat(m,"33"),children:o.jobName}),(0,e.jsx)(E.Z.Item,{span:12,label:(0,e.jsx)(l._H,{id:"monitor.Job.job_group",defaultMessage:"\u4EFB\u52A1\u7EC4\u540D",_nk:"".concat(m,"44")}),_nk:"".concat(m,"34"),children:v[o.jobGroup?o.jobGroup:"DEFAULT"]}),(0,e.jsx)(E.Z.Item,{span:24,label:(0,e.jsx)(l._H,{id:"monitor.Job.invoke_target",defaultMessage:"\u8C03\u7528\u76EE\u6807",_nk:"".concat(m,"45")}),_nk:"".concat(m,"35"),children:o.invokeTarget}),(0,e.jsx)(E.Z.Item,{span:24,label:(0,e.jsx)(l._H,{id:"monitor.Job.job_message",defaultMessage:"\u65E5\u5FD7\u4FE1\u606F",_nk:"".concat(m,"46")}),_nk:"".concat(m,"36"),children:o.jobMessage}),(0,e.jsx)(E.Z.Item,{span:24,label:(0,e.jsx)(l._H,{id:"monitor.Job.exception_info",defaultMessage:"\u5F02\u5E38\u4FE1\u606F",_nk:"".concat(m,"47")}),_nk:"".concat(m,"37"),children:o.exceptionInfo}),(0,e.jsx)(E.Z.Item,{span:12,label:(0,e.jsx)(l._H,{id:"monitor.Job.status",defaultMessage:"\u6267\u884C\u72B6\u6001",_nk:"".concat(m,"48")}),_nk:"".concat(m,"38"),children:d[o.status?o.status:0]})]})})},fe=de,K=u(52346),he=u(28524),a="lYyh",Q=function(){var c=(0,p.Z)((0,r.Z)().mark(function n(i){var t,s;return(0,r.Z)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(t=b.default.loading("\u6B63\u5728\u5220\u9664"),i){d.next=3;break}return d.abrupt("return",!0);case 3:return d.prev=3,d.next=6,Y(i.map(function(v){return v.jobLogId}).join(","));case 6:return s=d.sent,t(),s.code===200?b.default.success("\u5220\u9664\u6210\u529F\uFF0C\u5373\u5C06\u5237\u65B0"):b.default.error(s.msg),d.abrupt("return",!0);case 12:return d.prev=12,d.t0=d.catch(3),t(),b.default.error("\u5220\u9664\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"),d.abrupt("return",!1);case 17:case"end":return d.stop()}},n,null,[[3,12]])}));return function(i){return c.apply(this,arguments)}}(),ve=function(){var c=(0,p.Z)((0,r.Z)().mark(function n(){var i,t;return(0,r.Z)().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return i=b.default.loading("\u6B63\u5728\u5220\u9664"),o.prev=1,o.next=4,ce();case 4:return t=o.sent,i(),t.code===200?b.default.success("\u5220\u9664\u6210\u529F\uFF0C\u5373\u5C06\u5237\u65B0"):b.default.error(t.msg),o.abrupt("return",!0);case 10:return o.prev=10,o.t0=o.catch(1),i(),b.default.error("\u5220\u9664\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"),o.abrupt("return",!1);case 15:case"end":return o.stop()}},n,null,[[1,10]])}));return function(){return c.apply(this,arguments)}}(),me=function(){var c=(0,p.Z)((0,r.Z)().mark(function n(i){var t,s,o;return(0,r.Z)().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(t=b.default.loading("\u6B63\u5728\u5220\u9664"),i){v.next=3;break}return v.abrupt("return",!0);case 3:return v.prev=3,s=[i.jobLogId],v.next=7,Y(s.join(","));case 7:return o=v.sent,t(),o.code===200?b.default.success("\u5220\u9664\u6210\u529F\uFF0C\u5373\u5C06\u5237\u65B0"):b.default.error(o.msg),v.abrupt("return",!0);case 13:return v.prev=13,v.t0=v.catch(3),t(),b.default.error("\u5220\u9664\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"),v.abrupt("return",!1);case 18:case"end":return v.stop()}},n,null,[[3,13]])}));return function(i){return c.apply(this,arguments)}}(),ge=function(){var c=(0,p.Z)((0,r.Z)().mark(function n(){var i;return(0,r.Z)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return i=b.default.loading("\u6B63\u5728\u5BFC\u51FA"),s.prev=1,s.next=4,le();case 4:return i(),b.default.success("\u5BFC\u51FA\u6210\u529F"),s.abrupt("return",!0);case 9:return s.prev=9,s.t0=s.catch(1),i(),b.default.error("\u5BFC\u51FA\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"),s.abrupt("return",!1);case 14:case"end":return s.stop()}},n,null,[[1,9]])}));return function(){return c.apply(this,arguments)}}(),pe=function(){var n=(0,T.useRef)(),i=(0,T.useState)(!1),t=(0,R.Z)(i,2),s=t[0],o=t[1],d=(0,T.useRef)(),v=(0,T.useState)(),$=(0,R.Z)(v,2),U=$[0],S=$[1],V=(0,T.useState)([]),X=(0,R.Z)(V,2),F=X[0],z=X[1],je=(0,T.useState)([]),q=(0,R.Z)(je,2),_=q[0],Ze=q[1],ke=(0,T.useState)([]),ee=(0,R.Z)(ke,2),ne=ee[0],ye=ee[1],J=(0,l.md)(),Le=(0,l.YB)();(0,T.useEffect)(function(){(0,K.zP)("sys_job_status").then(function(Z){if(Z.code===200){var g={};Z.data.forEach(function(h){g[h.dictValue]=h.dictLabel}),Ze(g)}}),(0,K.zP)("sys_job_group").then(function(Z){if(Z.code===200){var g={};Z.data.forEach(function(h){g[h.dictValue]=h.dictLabel}),ye(g)}})},[]);var Te=[{title:(0,e.jsx)(l._H,{id:"monitor.JobLog.job_log_id",defaultMessage:"\u4EFB\u52A1\u65E5\u5FD7ID",_nk:"".concat(a,"11")}),dataIndex:"jobLogId",valueType:"text",hideInSearch:!0},{title:(0,e.jsx)(l._H,{id:"monitor.JobLog.job_name",defaultMessage:"\u4EFB\u52A1\u540D\u79F0",_nk:"".concat(a,"12")}),dataIndex:"jobName",valueType:"text"},{title:(0,e.jsx)(l._H,{id:"monitor.JobLog.job_group",defaultMessage:"\u4EFB\u52A1\u7EC4\u540D",_nk:"".concat(a,"13")}),dataIndex:"jobGroup",valueType:"text",valueEnum:ne},{title:(0,e.jsx)(l._H,{id:"monitor.JobLog.invoke_target",defaultMessage:"\u8C03\u7528\u76EE\u6807\u5B57\u7B26\u4E32",_nk:"".concat(a,"14")}),dataIndex:"invokeTarget",valueType:"textarea",hideInSearch:!0},{title:(0,e.jsx)(l._H,{id:"monitor.JobLog.job_message",defaultMessage:"\u65E5\u5FD7\u4FE1\u606F",_nk:"".concat(a,"15")}),dataIndex:"jobMessage",valueType:"textarea",hideInSearch:!0},{title:(0,e.jsx)(l._H,{id:"monitor.JobLog.status",defaultMessage:"\u6267\u884C\u72B6\u6001",_nk:"".concat(a,"16")}),dataIndex:"status",valueType:"select",valueEnum:_},{title:(0,e.jsx)(l._H,{id:"pages.searchTable.titleOption",defaultMessage:"\u64CD\u4F5C",_nk:"".concat(a,"17")}),dataIndex:"option",width:"220px",valueType:"option",render:function(g,h){return[(0,e.jsx)(x.Z,{type:"link",size:"small",hidden:!J.hasPerms("monitor:log:list"),onClick:function(){o(!0),S(h)},_nk:"".concat(a,"21"),children:"\u8BE6\u7EC6"},"detail"),(0,e.jsx)(x.Z,{type:"link",size:"small",danger:!0,hidden:!J.hasPerms("monitor:log:remove"),onClick:(0,p.Z)((0,r.Z)().mark(function f(){return(0,r.Z)().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:O.Z.confirm({title:"\u5220\u9664",content:"\u786E\u5B9A\u5220\u9664\u8BE5\u9879\u5417\uFF1F",okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88",onOk:function(){var k=(0,p.Z)((0,r.Z)().mark(function L(){var C;return(0,r.Z)().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.next=2,me(h);case 2:C=I.sent,C&&d.current&&d.current.reload();case 4:case"end":return I.stop()}},L)}));function j(){return k.apply(this,arguments)}return j}()});case 1:case"end":return w.stop()}},f)})),_nk:"".concat(a,"22"),children:"\u5220\u9664"},"batchRemove")]}}];return(0,e.jsxs)(he.Z,{_nk:"".concat(a,"31"),children:[(0,e.jsx)("div",{style:{width:"100%",float:"right"},_nk:"".concat(a,"41"),children:(0,e.jsx)(se.ZP,{headerTitle:Le.formatMessage({id:"pages.searchTable.title",defaultMessage:"\u4FE1\u606F"}),actionRef:d,formRef:n,rowKey:"jobLogId",search:{labelWidth:120},toolBarRender:function(){return[(0,e.jsxs)(x.Z,{type:"primary",hidden:(F==null?void 0:F.length)===0||!J.hasPerms("monitor:log:remove"),onClick:(0,p.Z)((0,r.Z)().mark(function g(){return(0,r.Z)().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:O.Z.confirm({title:"\u662F\u5426\u786E\u8BA4\u5220\u9664\u6240\u9009\u6570\u636E\u9879?",icon:(0,e.jsx)(W.Z,{_nk:"".concat(a,"61")}),content:"\u8BF7\u8C28\u614E\u64CD\u4F5C",onOk:function(){return(0,p.Z)((0,r.Z)().mark(function w(){var k,j,L;return(0,r.Z)().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,Q(F);case 2:k=y.sent,k&&(z([]),(j=d.current)===null||j===void 0||(L=j.reloadAndRest)===null||L===void 0||L.call(j));case 4:case"end":return y.stop()}},w)}))()},onCancel:function(){}});case 1:case"end":return f.stop()}},g)})),_nk:"".concat(a,"23"),children:[(0,e.jsx)(te.Z,{_nk:"".concat(a,"71")}),(0,e.jsx)(l._H,{id:"pages.searchTable.delete",defaultMessage:"\u5220\u9664",_nk:"".concat(a,"18")})]},"remove"),(0,e.jsxs)(x.Z,{type:"primary",hidden:!J.hasPerms("monitor:operlog:remove"),onClick:(0,p.Z)((0,r.Z)().mark(function g(){return(0,r.Z)().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:O.Z.confirm({title:"\u662F\u5426\u786E\u8BA4\u6E05\u7A7A\u6240\u6709\u767B\u5F55\u65E5\u5FD7\u6570\u636E\u9879?",icon:(0,e.jsx)(W.Z,{_nk:"".concat(a,"62")}),content:"\u8BF7\u8C28\u614E\u64CD\u4F5C",onOk:function(){return(0,p.Z)((0,r.Z)().mark(function w(){var k,j;return(0,r.Z)().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:ve(),(k=d.current)===null||k===void 0||(j=k.reloadAndRest)===null||j===void 0||j.call(k);case 2:case"end":return C.stop()}},w)}))()},onCancel:function(){}});case 1:case"end":return f.stop()}},g)})),_nk:"".concat(a,"24"),children:[(0,e.jsx)(H.Z,{_nk:"".concat(a,"81")}),(0,e.jsx)(l._H,{id:"pages.searchTable.clear",defaultMessage:"\u6E05\u7A7A",_nk:"".concat(a,"19")})]},"clear"),(0,e.jsxs)(x.Z,{type:"primary",hidden:!J.hasPerms("monitor:log:export"),onClick:(0,p.Z)((0,r.Z)().mark(function g(){return(0,r.Z)().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:ge();case 1:case"end":return f.stop()}},g)})),_nk:"".concat(a,"25"),children:[(0,e.jsx)(H.Z,{_nk:"".concat(a,"82")}),(0,e.jsx)(l._H,{id:"pages.searchTable.export",defaultMessage:"\u5BFC\u51FA",_nk:"".concat(a,"1a")})]},"export"),(0,e.jsxs)(x.Z,{type:"primary",onClick:(0,p.Z)((0,r.Z)().mark(function g(){return(0,r.Z)().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:l.m8.goBack();case 1:case"end":return f.stop()}},g)})),_nk:"".concat(a,"26"),children:[(0,e.jsx)(H.Z,{_nk:"".concat(a,"83")}),(0,e.jsx)(l._H,{id:"pages.goback",defaultMessage:"\u8FD4\u56DE",_nk:"".concat(a,"1b")})]},"goback")]},request:function(g){return ue((0,ae.Z)({},g)).then(function(h){var f={data:h.rows,total:h.total,success:!0};return f})},columns:Te,rowSelection:{onChange:function(g,h){z(h)}},_nk:"".concat(a,"51")},"jobLogList")}),(F==null?void 0:F.length)>0&&(0,e.jsx)(re.Z,{extra:(0,e.jsxs)("div",{_nk:"".concat(a,"42"),children:[(0,e.jsx)(l._H,{id:"pages.searchTable.chosen",defaultMessage:"\u5DF2\u9009\u62E9",_nk:"".concat(a,"1c")}),(0,e.jsx)("a",{style:{fontWeight:600},_nk:"".concat(a,"a1"),children:F.length}),(0,e.jsx)(l._H,{id:"pages.searchTable.item",defaultMessage:"\u9879",_nk:"".concat(a,"1d")})]}),_nk:"".concat(a,"91"),children:(0,e.jsx)(x.Z,{hidden:!J.hasPerms("monitor:log:remove"),onClick:(0,p.Z)((0,r.Z)().mark(function Z(){return(0,r.Z)().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:O.Z.confirm({title:"\u5220\u9664",content:"\u786E\u5B9A\u5220\u9664\u8BE5\u9879\u5417\uFF1F",okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88",onOk:function(){var f=(0,p.Z)((0,r.Z)().mark(function w(){var k,j,L;return(0,r.Z)().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,Q(F);case 2:k=y.sent,k&&(z([]),(j=d.current)===null||j===void 0||(L=j.reloadAndRest)===null||L===void 0||L.call(j));case 4:case"end":return y.stop()}},w)}));function M(){return f.apply(this,arguments)}return M}()});case 1:case"end":return h.stop()}},Z)})),_nk:"".concat(a,"27"),children:(0,e.jsx)(l._H,{id:"pages.searchTable.batchDeletion",defaultMessage:"\u6279\u91CF\u5220\u9664",_nk:"".concat(a,"1e")})},"remove")}),(0,e.jsx)(fe,{onCancel:function(){o(!1),S(void 0)},visible:s,values:U||{},statusOptions:_,jobGroupOptions:ne,_nk:"".concat(a,"b1")})]})},be=pe}}]);
