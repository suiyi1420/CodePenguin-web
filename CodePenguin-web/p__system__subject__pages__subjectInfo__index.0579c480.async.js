(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[6207],{92062:function(N){N.exports={wraper:"wraper___1cKnG"}},28524:function(N,O,n){"use strict";var F=n(92062),o=n.n(F),c=n(85893),f="cpPz",X=function(D){return(0,c.jsx)("div",{className:o().wraper,_nk:"".concat(f,"11"),children:D.children})};O.Z=X},30372:function(N,O,n){"use strict";n.r(O),n.d(O,{default:function(){return L}});var F=n(39428),o=n(66456),c=n(64411),f=n(3182),X=n(34792),E=n(48086),D=n(71194),R=n(50146),U=n(57663),S=n(71577),h=n(2824),ne=n(47673),B=n(4107),m=n(67294),C=n(69955),Y=n(28524),k=n(43581),K=n(43358),g=n(34041),J=n(9715),j=n(55843),$=n(28487),r=n(30896),t=n(85893),i="6Dsw",Q=function(v){var u=j.Z.useForm(),a=(0,h.Z)(u,1),s=a[0],e=v.isModalOpen,_=v.handleCancel,P=v.subject_id,I=v.type,V=v.subject_info,ue=v.callBack,re=(0,m.useState)(0),te=(0,h.Z)(re,2),ae=te[0],se=te[1];(0,m.useMemo)(function(){I==r.L.\u7F16\u8F91&&(console.log(I,V),s.setFieldsValue(V))},[V,I]);var oe=function(){s.validateFields().then(function(y){console.log(y),y.subject_id=P,I==r.L.\u6DFB\u52A0?(0,C.sn)(y).then(function(A){A.code==200?(E.default.success("\u8BFE\u65F6\u6DFB\u52A0\u6210\u529F"),_(),ue()):E.default.error("\u8BFE\u65F6\u6DFB\u52A0\u5931\u8D25")}).catch(function(A){return console.log(A.message)}):(y.subject_info_id=V.subject_info_id,(0,C.TE)(y).then(function(A){A.code==200?(E.default.success("\u8BFE\u65F6\u4FEE\u6539\u6210\u529F"),_(),ue()):E.default.error("\u8BFE\u65F6\u4FEE\u6539\u5931\u8D25")}).catch(function(A){return console.log(A.message)}))})};return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(R.Z,{title:I==r.L.\u6DFB\u52A0?"\u6DFB\u52A0\u8BFE\u65F6":"\u7F16\u8F91\u8BFE\u65F6",open:e,onOk:oe,onCancel:_,_nk:"".concat(i,"11"),children:(0,t.jsxs)(j.Z,{form:s,labelCol:{span:6},wrapperCol:{span:18},style:{maxWidth:600},_nk:"".concat(i,"21"),children:[(0,t.jsx)(j.Z.Item,{label:"\u8BFE\u65F6\u540D\u79F0",name:"name",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u8BFE\u7A0B\u540D\u79F0!"}],style:{marginBottom:24},_nk:"".concat(i,"31"),children:(0,t.jsx)(B.Z,{_nk:"".concat(i,"41")})}),(0,t.jsx)(j.Z.Item,{label:"\u8BFE\u65F6\u5185\u5BB9",name:"context",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u8BFE\u7A0B\u540D\u79F0!"}],style:{marginBottom:24},_nk:"".concat(i,"32"),children:(0,t.jsx)(B.Z.TextArea,{rows:4,_nk:"".concat(i,"33")})}),(0,t.jsx)(j.Z.Item,{label:"\u77E5\u8BC6\u70B9",name:"knowledge",rules:[{required:!1,message:"\u8BF7\u8F93\u5165\u8BFE\u7A0B\u540D\u79F0!"}],style:{marginBottom:24},_nk:"".concat(i,"34"),children:(0,t.jsx)(B.Z.TextArea,{rows:4,_nk:"".concat(i,"35")})}),(0,t.jsx)(j.Z.Item,{label:"\u8BFE\u4EF6",name:"pdf_url",rules:[{required:!0,message:"\u8BF7\u4E0A\u4F20pdf\u6587\u4EF6\uFF01!"}],style:{marginBottom:24},_nk:"".concat(i,"36"),children:(0,t.jsx)($.Z,{type:"pdf",uploadPath:"pdf",callBack:function(y){return s.setFieldValue("pdf_url",y)},_nk:"".concat(i,"51")})}),(0,t.jsx)(j.Z.Item,{label:"\u8BFE\u7A0B\u7C7B\u578B",name:"type",style:{marginBottom:24},rules:[{required:I==r.L.\u6DFB\u52A0,message:"\u8BF7\u9009\u62E9\u8BFE\u7A0B\u7C7B\u578B\uFF01!"}],initialValue:0,_nk:"".concat(i,"37"),children:(0,t.jsxs)(g.Z,{style:{width:220},onChange:function(y){return se(y)},defaultValue:r.fH.\u7F16\u7A0B\u5C0F\u8282,_nk:"".concat(i,"61"),children:[(0,t.jsx)(g.Z.Option,{value:r.fH.\u7F16\u7A0B\u5C0F\u8282,_nk:"".concat(i,"38"),children:"\u7F16\u7A0B\u5C0F\u8282"}),(0,t.jsx)(g.Z.Option,{value:r.fH.\u89C6\u9891\u5C0F\u8282,_nk:"".concat(i,"39"),children:"\u89C6\u9891\u5C0F\u8282"}),(0,t.jsx)(g.Z.Option,{value:r.fH.\u8BFE\u7A0B\u89C6\u9891,_nk:"".concat(i,"3a"),children:"\u8BFE\u7A0B\u89C6\u9891"})]})}),ae===r.fH.\u8BFE\u7A0B\u89C6\u9891?(0,t.jsx)(j.Z.Item,{label:"\u89C6\u9891\u4E0A\u4F20",name:"url",rules:[{required:I==r.L.\u6DFB\u52A0,message:"\u8BF7\u4E0A\u4F20\u89C6\u9891\u6587\u4EF6\uFF01!"}],style:{marginBottom:24},_nk:"".concat(i,"3b"),children:(0,t.jsx)($.Z,{type:"video",uploadPath:"video/subject_id"+P,callBack:function(y){return s.setFieldValue("url",y)},_nk:"".concat(i,"52")})}):null,(0,t.jsx)(j.Z.Item,{label:"\u5C0F\u8282\u4FDD\u5B58\u6A21\u5F0F",name:"save_file_type",style:{marginBottom:24},rules:[{required:I==r.L.\u6DFB\u52A0,message:"\u8BF7\u9009\u62E9\u5C0F\u8282\u4FDD\u5B58\u6A21\u5F0F\uFF01!"}],initialValue:0,_nk:"".concat(i,"3c"),children:(0,t.jsxs)(g.Z,{style:{width:220},onChange:function(y){return se(y)},defaultValue:r.Wd.\u6240\u6709\u5C0F\u8282\u4E00\u4E2A\u6587\u4EF6,_nk:"".concat(i,"62"),children:[(0,t.jsx)(g.Z.Option,{value:r.Wd.\u6240\u6709\u5C0F\u8282\u4E00\u4E2A\u6587\u4EF6,_nk:"".concat(i,"3d"),children:"\u6240\u6709\u5C0F\u8282\u4E00\u4E2A\u6587\u4EF6"}),(0,t.jsx)(g.Z.Option,{value:r.Wd.\u6BCF\u4E00\u5C0F\u8282\u4E00\u4E2A\u6587\u4EF6,_nk:"".concat(i,"3e"),children:"\u6BCF\u4E00\u5C0F\u8282\u4E00\u4E2A\u6587\u4EF6"})]})})]})})})},M=Q,T=n(57119),l=n(60923),d="WEar",H=B.Z.Search,q=function(v){var u=v.location,a=u.state.subjectId,s=(0,k.tT)("@@initialState"),e=s.initialState,_=(0,k.md)();console.log("subjectId",a);var P=(0,m.useState)([]),I=(0,h.Z)(P,2),V=I[0],ue=I[1],re=(0,m.useState)(""),te=(0,h.Z)(re,2),ae=te[0],se=te[1],oe=(0,m.useState)(e==null?void 0:e.userConfig["stratch-web"]),W=(0,h.Z)(oe,2),y=W[0],A=W[1],ye=(0,m.useState)(!1),de=(0,h.Z)(ye,2),be=de[0],le=de[1],ge=(0,m.useState)(r.L.\u6DFB\u52A0),fe=(0,h.Z)(ge,2),ve=fe[0],me=fe[1],Ze=(0,m.useState)({}),pe=(0,h.Z)(Ze,2),Ee=pe[0],Se=pe[1],Ce=localStorage.getItem("access_token"),Be=(0,m.useState)(""),_e=(0,h.Z)(Be,2),ke=_e[0],Ae=_e[1],Ie=(0,m.useState)(!1),he=(0,h.Z)(Ie,2),we=he[0],De=he[1],Fe=(0,m.useState)(r.vz.video),je=(0,h.Z)(Fe,2),Me=je[0],Te=je[1],Pe=[{title:"\u5E8F\u53F7",dataIndex:"num",key:"num",width:"3%",render:function(b,p,w){return parseInt(w+1)}},{title:"\u8BFE\u7A0B\u540D\u79F0",dataIndex:"name",key:"name",width:"13%"},{title:"\u8BFE\u65F6\u5185\u5BB9",dataIndex:"context",key:"context",width:"18%"},{title:"\u77E5\u8BC6\u70B9",dataIndex:"knowledge",key:"knowledge",width:"18%",render:function(b){return(0,t.jsx)(B.Z.TextArea,{value:b,autoSize:!0,bordered:!1,_nk:"".concat(d,"11")})}},{title:"\u7C7B\u578B",dataIndex:"type",key:"type",width:"6%",render:function(b){return r.Gs[b]}},{title:"\u6587\u4EF6\u4FDD\u5B58\u7C7B\u578B",dataIndex:"save_file_type",key:"save_file_type",width:"10%",render:function(b){return(0,r.V9)(r.Wd,b)}},{title:"\u64CD\u4F5C",dataIndex:"subject_info_id",key:"subject_info_id",width:"32%",render:function(b,p,w){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(S.Z,{type:"dashed",onClick:function(){Se(p),me(r.L.\u7F16\u8F91),le(!0)},hidden:!_.hasPerms("system:subject_info:edit"),_nk:"".concat(d,"21"),children:"\u7F16\u8F91\u8BFE\u7A0B"}),p&&p.pdf_url&&p.pdf_url!==""&&(0,t.jsxs)(t.Fragment,{children:["\xA0",(0,t.jsx)(S.Z,{type:"primary",onClick:function(){var Z=l.Z.base+"/video_pdf";Z=Z.replaceAll("//","/"),window.open(window.location.origin+Z+"?subjectInfoId="+p.subject_info_id+"&type="+r.vz.pdf)},_nk:"".concat(d,"22"),children:"\u8BFE\u7A0B\u8BFE\u4EF6"})]}),p&&(p.type==r.fH.\u7F16\u7A0B\u5C0F\u8282||p.type==r.fH.\u89C6\u9891\u5C0F\u8282)&&(0,t.jsxs)(t.Fragment,{children:["\xA0",(0,t.jsx)(S.Z,{type:"dashed",onClick:function(){k.m8.push({pathname:"/system/subject/subjectInfo/subsection",state:{subjectInfoId:p.subject_info_id,subjectInfoType:p.type}})},hidden:!_.hasPerms("system:subject_subsection:list"),_nk:"".concat(d,"23"),children:"\u67E5\u770B\u5C0F\u8282"})]}),p&&p.type==r.fH.\u8BFE\u7A0B\u89C6\u9891&&(0,t.jsxs)(t.Fragment,{children:["\xA0",(0,t.jsx)(S.Z,{type:"primary",onClick:function(){var Z=l.Z.base+"/video_pdf";Z=Z.replaceAll("//","/"),window.open(window.location.origin+Z+"?subjectInfoId="+p.subject_info_id+"&type="+r.vz.video)},_nk:"".concat(d,"24"),children:"\u6311\u6218\u8BFE\u7A0B"})]}),p&&p.type==r.fH.\u89C6\u9891\u5C0F\u8282&&(0,t.jsxs)(t.Fragment,{children:["\xA0",(0,t.jsx)(S.Z,{type:"primary",onClick:function(){console.log("defaultSettings.base",l.Z.base);var Z=l.Z.base+"/video";Z=Z.replaceAll("//","/"),window.open(window.location.origin+Z+"?subjectInfoId="+p.subject_info_id)},_nk:"".concat(d,"25"),children:"\u6311\u6218\u8BFE\u7A0B"})]}),p&&p.type==r.fH.\u7F16\u7A0B\u5C0F\u8282&&(0,t.jsxs)(t.Fragment,{children:["\xA0",(0,t.jsx)(S.Z,{type:"primary",onClick:function(){window.open(y+"?subject_info_id="+b+"&access="+Ce)},_nk:"".concat(d,"26"),children:"\u6311\u6218\u8BFE\u7A0B"})]}),"\xA0",(0,t.jsx)(S.Z,{type:"primary",ghost:!0,danger:!0,hidden:!_.hasPerms("system:subject_info:delete"),onClick:function(){R.Z.confirm({icon:(0,t.jsx)(T.Z,{_nk:"".concat(d,"31")}),title:"\u5220\u9664\u8BFE\u7A0B",content:"\u662F\u5426\u786E\u5B9A\u5220\u9664\u8BE5\u8BFE\u7A0B\uFF1F",onOk:function(Oe){(0,C.bO)(b).then(function(z){console.log("res",z),z.code==200||z.code=="200"?(E.default.success("\u5220\u9664\u6210\u529F"),ie(),Oe()):E.default.warning(z.msg)}).catch(function(z){return E.default.error(z.message)})},onCancel:function(){}})},_nk:"".concat(d,"27"),children:"\u5220\u9664\u8BFE\u7A0B"})]})}}];(0,m.useEffect)(function(){ie()},[a,ae]);function ie(){return ce.apply(this,arguments)}function ce(){return ce=(0,f.Z)((0,F.Z)().mark(function x(){var b;return(0,F.Z)().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,(0,C.oc)(a,ae);case 2:b=w.sent,console.log("res",b),ue(b.data);case 5:case"end":return w.stop()}},x)})),ce.apply(this,arguments)}var xe=function(b){return se(b)};return(0,t.jsxs)(Y.Z,{_nk:"".concat(d,"41"),children:[(0,t.jsxs)("div",{style:{width:"100%",float:"right"},_nk:"".concat(d,"51"),children:[(0,t.jsxs)("p",{_nk:"".concat(d,"61"),children:[(0,t.jsx)(H,{placeholder:"\u8BF7\u8F93\u5165\u8BFE\u7A0B\u540D\u79F0",allowClear:!0,enterButton:"\u641C\u7D22",onSearch:xe,style:{width:300},_nk:"".concat(d,"71")}),"\xA0\xA0\xA0\xA0",(0,t.jsx)(S.Z,{type:"primary",onClick:function(){me(r.L.\u6DFB\u52A0),le(!0)},hidden:!_.hasPerms("system:subject_info:add"),_nk:"".concat(d,"28"),children:"\u6DFB\u52A0\u8BFE\u65F6"})]}),(0,t.jsx)(c.Z,{columns:Pe,dataSource:V,pagination:!1,_nk:"".concat(d,"81")})]}),be&&(0,t.jsx)(M,{subject_id:a,isModalOpen:!0,type:ve,subject_info:Ee,handleCancel:function(){return le(!1)},callBack:ie,_nk:"".concat(d,"91")})]})},L=q},28487:function(N,O,n){"use strict";var F=n(11849),o=n(43185),c=n(93009),f=n(57663),X=n(71577),E=n(86582),D=n(34792),R=n(48086),U=n(2824),S=n(67294),h=n(84391),ne=n(69955),B=n(30896),m=n(85893),C="0Ygb",Y=function(K){var g=K.type,J=K.callBack,j=K.uploadPath,$=(0,S.useState)([]),r=(0,U.Z)($,2),t=r[0],i=r[1],Q=B.Dq[g],M={multiple:!1,accept:Q,fileList:t,maxCount:1,onChange:function(l){console.log("onChange",l),l.file.status!=="uploading"&&console.log(l.file,l.fileList),l.file.status==="done"?console.log("".concat(l.file.name," \u6587\u4EF6\u4E0A\u4F20\u6210\u529F")):l.file.status==="error"&&R.default.error("".concat(l.file.name," \u6587\u4EF6\u4E0A\u4F20\u5931\u8D25")),i((0,E.Z)(l.fileList))},onStart:function(l){console.log("onStart",l,l.name)},onError:function(l){console.log("onError",l)},customRequest:function(l){var d=l.file,H=l.filename,q=l.onError,L=l.onProgress,ee=l.onSuccess,v=l.withCredentials,u=new FormData;return u.append("file",d),u.append("type",j),(0,ne.t4)(u,{onReqProgress:function(s){console.log("onReqProgress",Math.round(s.loaded/s.total*100).toFixed(2)),L({percent:Math.round(s.loaded/s.total*100).toFixed(2)},d)}}).then(function(a){setTimeout(function(){ee()}),a.code==200&&a.url!==""&&J&&J(a.url)}).catch(q),{abort:function(){console.log("upload progress is aborted.")}}}};return(0,m.jsx)(m.Fragment,{children:(0,m.jsx)(c.Z,(0,F.Z)((0,F.Z)({},M),{},{_nk:"".concat(C,"11"),children:(0,m.jsx)(X.Z,{icon:(0,m.jsx)(h.Z,{_nk:"".concat(C,"31")}),_nk:"".concat(C,"21"),children:"\u9009\u62E9\u6587\u4EF6"})}))})};O.Z=Y},69955:function(N,O,n){"use strict";n.d(O,{Xi:function(){return E},oc:function(){return R},lt:function(){return S},h1:function(){return ne},t4:function(){return m},oG:function(){return Y},$h:function(){return K},Pl:function(){return J},sn:function(){return $},TE:function(){return t},qx:function(){return Q},St:function(){return T},Zg:function(){return d},fW:function(){return q},bO:function(){return ee}});var F=n(11849),o=n(39428),c=n(3182),f=n(86072),X="+rss";function E(u){return D.apply(this,arguments)}function D(){return D=(0,c.Z)((0,o.Z)().mark(function u(a){return(0,o.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,f.Z)("/system/subject/list",{method:"POST",data:{id:a}}));case 1:case"end":return e.stop()}},u)})),D.apply(this,arguments)}function R(u,a){return U.apply(this,arguments)}function U(){return U=(0,c.Z)((0,o.Z)().mark(function u(a,s){return(0,o.Z)().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",(0,f.Z)("/system/subject/info_list",{method:"POST",data:{id:a,keyWord:s||""}}));case 1:case"end":return _.stop()}},u)})),U.apply(this,arguments)}function S(u){return h.apply(this,arguments)}function h(){return h=(0,c.Z)((0,o.Z)().mark(function u(a){return(0,o.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,f.Z)("/system/subject/info/"+a,{method:"POST"}));case 1:case"end":return e.stop()}},u)})),h.apply(this,arguments)}function ne(){return B.apply(this,arguments)}function B(){return B=(0,c.Z)((0,o.Z)().mark(function u(){return(0,o.Z)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,f.Z)("/system/subject/type_list",{method:"GET"}));case 1:case"end":return s.stop()}},u)})),B.apply(this,arguments)}function m(u){return C.apply(this,arguments)}function C(){return C=(0,c.Z)((0,o.Z)().mark(function u(a){var s,e=arguments;return(0,o.Z)().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return s=e.length>1&&e[1]!==void 0?e[1]:{},P.abrupt("return",(0,f.Z)("/system/user/profile/subject_upload",(0,F.Z)({method:"post",data:a},s)));case 2:case"end":return P.stop()}},u)})),C.apply(this,arguments)}function Y(u){return k.apply(this,arguments)}function k(){return k=(0,c.Z)((0,o.Z)().mark(function u(a){return(0,o.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,f.Z)("/system/subject/add",{method:"post",data:a}));case 1:case"end":return e.stop()}},u)})),k.apply(this,arguments)}function K(u){return g.apply(this,arguments)}function g(){return g=(0,c.Z)((0,o.Z)().mark(function u(a){return(0,o.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,f.Z)("/system/subject/edit",{method:"post",data:a}));case 1:case"end":return e.stop()}},u)})),g.apply(this,arguments)}function J(u){return j.apply(this,arguments)}function j(){return j=(0,c.Z)((0,o.Z)().mark(function u(a){return(0,o.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,f.Z)("/system/subject/delete/"+a,{method:"post"}));case 1:case"end":return e.stop()}},u)})),j.apply(this,arguments)}function $(u){return r.apply(this,arguments)}function r(){return r=(0,c.Z)((0,o.Z)().mark(function u(a){return(0,o.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,f.Z)("/system/subject/subject_info/add",{method:"post",data:a}));case 1:case"end":return e.stop()}},u)})),r.apply(this,arguments)}function t(u){return i.apply(this,arguments)}function i(){return i=(0,c.Z)((0,o.Z)().mark(function u(a){return(0,o.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,f.Z)("/system/subject/subject_info/edit",{method:"post",data:a}));case 1:case"end":return e.stop()}},u)})),i.apply(this,arguments)}function Q(u,a){return M.apply(this,arguments)}function M(){return M=(0,c.Z)((0,o.Z)().mark(function u(a,s){return(0,o.Z)().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",(0,f.Z)("/system/subject/subsection/list",{method:"POST",data:{id:a,keyWord:s||""}}));case 1:case"end":return _.stop()}},u)})),M.apply(this,arguments)}function T(u){return l.apply(this,arguments)}function l(){return l=(0,c.Z)((0,o.Z)().mark(function u(a){return(0,o.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,f.Z)("/system/subject/subsection/add",{method:"post",data:a}));case 1:case"end":return e.stop()}},u)})),l.apply(this,arguments)}function d(u){return H.apply(this,arguments)}function H(){return H=(0,c.Z)((0,o.Z)().mark(function u(a){return(0,o.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,f.Z)("/system/subject/subsection/edit",{method:"post",data:a}));case 1:case"end":return e.stop()}},u)})),H.apply(this,arguments)}function q(u){return L.apply(this,arguments)}function L(){return L=(0,c.Z)((0,o.Z)().mark(function u(a){return(0,o.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,f.Z)("/system/subject/subsection/delete/"+a,{method:"post"}));case 1:case"end":return e.stop()}},u)})),L.apply(this,arguments)}function ee(u){return v.apply(this,arguments)}function v(){return v=(0,c.Z)((0,o.Z)().mark(function u(a){return(0,o.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,f.Z)("/system/subject/subject_info/delete/"+a,{method:"post"}));case 1:case"end":return e.stop()}},u)})),v.apply(this,arguments)}}}]);
